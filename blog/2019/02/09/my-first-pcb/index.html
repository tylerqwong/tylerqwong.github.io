<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>My First PCB! - Laura Lindzey</title>

    <meta name="author" content="Laura Lindzey">

    <link rel="stylesheet" href="/theme/css/main.css?">
    <link rel="stylesheet" href="/theme/css/pygment.css?">

    <link rel="icon" href="/images/favicon.ico" type="image/x-icon">

    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<link href="/feeds/all.atom.xml" rel="alternate" title="Laura Lindzey" type="application/atom+xml">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-43181776-1']);
    _gaq.push(['_trackPageview']);
    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>
  </head>
  <body>
      <header>
        <h1><a href="/index.html">Laura Lindzey</a></h1>
        <span class="tagline"> robots, science, code </span>
        <br>
<nav id="main-nav">
  <ul>
    <li><a href="/index.html">Blog</a></li>
    <li><a href="/archives.html">Archives</a></li>
    <li><a href="/pages/about.html">About</a></li>
  </ul>
</nav>
      </header>
      <section>
<article class="post">
    <h2 class="title">
      My First PCB!
    </h2>
    <div class="meta">
      <div class="date">February 09, 2019</div>
    </div>
  <div class="entry-content">
    <p>Designing a PCB<sup id="sf-my-first-pcb-1-back"><a title=" A Printed Circuit Board (PCB) provides places to attach the components in your circuit (pads/footprints) and provides the required electrical connections between them (traces). " class="simple-footnote" href="#sf-my-first-pcb-1">1</a></sup> and sending it off to fab is surprisingly accessible and feels like a super power.
I’d been intimidated for years, but finally jumped in.
Also, I love living in the future! For &lt;$20, you can design a PCB, have it manufactured in a factory, and get it mailed to you.
This still seems insane to me.</p>
<p>This post describes the path I took to get my first PCB manufactured, with an emphasis on not getting sucked into optimizing every decision.
I’m assuming you already have a circuit drawn out or breadboarded<sup id="sf-my-first-pcb-2-back"><a title=" If you need inspiration, how about a LED that lights up when you push a button, or a LED that turns on in the dark? Or, check out the 100 simple circuits in the back of Forrest Mims's &quot;Getting Started in Electronics&quot;. " class="simple-footnote" href="#sf-my-first-pcb-2">2</a></sup>, and you want to immortalize it.</p>


<p>I estimate that going from “what is KiCAD even” to ordering your first PCB could be a reasonable one-day project for a simple circuit you already have sketched or breadboarded.
It only took me a few days because I was paying a lot of attention to the aesthetics of the board.</p>
<p><strong>My Circuit</strong></p>
<p>While doing a mini batch at the <a href="https://www.recurse.com/">Recurse Center</a>, I became fascinated by the oscillator circuit<sup id="sf-my-first-pcb-3-back"><a title=" These are lots of websites explaining how this works. Here's a nice simulation, and here's a simpler explanation. " class="simple-footnote" href="#sf-my-first-pcb-3">3</a></sup> that powered the <a href="https://github.com/strickinato/recurse-christmas-pcb">RC Christmas ornaments</a>.
I love how simple the circuit is, while generating visually-interesting behavior!</p>
<p><img title="Hand-drawn diagram of the oscillator circuit" class="center" alt="Hand-drawn diagram of the oscillator circuit" src="/images/my_first_pcb/schematic_handdrawn.jpg" style="width: 50%; max-width: 300px; height: auto"></p>
<!-- This version doesn't scale; it's just fixed. I couldn't get the liquid image tags to handle the percentage -->

<!-- {% img /images/my_first_pcb/schematic_handdrawn.jpg 300 auto "Hand-drawn diagram of the oscillator circuit" %} -->

<p>I wanted to play with varying the frequency of the oscillator by using different values of resistors and capacitors, so I made a protoboard wired up with female header to make this easy.
It turns out that LED color also makes a difference!
I dislike breadboarding for anything more extended than a proof-of-concept (it is the physical incarnation of spaghetti code) and protoboard<sup id="sf-my-first-pcb-4-back"><a title=" I'm always frustrated by the awkward layout and the fiddly solder bridges protoboard requires. However, it's useful if you want to make a breadboarded circuit more permanent without actually making a PCB. If you have to use protoboard, I like these from gikfun because they have the same electrical connectivity as a breadboard. (Adafruit's perma-proto is also good, but more expensive.) You can't get the layout as dense as you can on other protoboard, but it cuts down on how many solder bridges you have to create. " class="simple-footnote" href="#sf-my-first-pcb-4">4</a></sup> can be a pain to work with.
So, I figured an oscillator circuit with female headers for all of the components could be a fun first PCB to have fabricated.</p>
<div class="figure">
  <img height="auto" src="/images/my_first_pcb/breadboard.jpg" width="44%">
  <img height="auto" src="/images/my_first_pcb/protoboard.jpg" width="52%">
  <p class="caption">
    Early implementations of the oscillator. Left: on breadboard, Right: on protoboard.
  </p>
</div>

<p><strong> CAD tool for PCBs </strong></p>
<p>I really like <a href="http://kicad-pcb.org/">KiCAD</a><sup id="sf-my-first-pcb-5-back"><a title=" I used v4 for this project, but you should definitely use v5. They fixed a lot of the rough edges, and it's more pleasant all-around. " class="simple-footnote" href="#sf-my-first-pcb-5">5</a></sup> as a design tool because it decouples documenting the circuit logically from laying it out on a board.
This is great for when I want to have professional-ish schematics of things that I’m only ever going to implement in protoboard.
I think <a href="https://www.autodesk.com/products/eagle/overview">Eagle</a> is the main competitor, but it has a tight coupling between the logical schematic and the physical layout that forced me to care about component packaging and footprints way too early (like 2 years too early), so I bailed on it quickly.</p>
<p>Plus, KiCAD is open-source, which makes me happy.</p>
<p>There are 3 primary phases to designing a PCB in KiCAD:</p>
<ol>
<li>Use EESCHEMA to generate a <a href="https://learn.sparkfun.com/tutorials/how-to-read-a-schematic/all">schematic</a> for your circuit. This will be a digital version of the hand-drawn circuit from above.</li>
<li>Use CVPCB to associate each element in the schematic with a specific component’s footprint. For example, resistors come in many shapes and sizes, and before laying out a PCB, you need to choose which resistor to use. The footprint specifies its physical size, connections to the board, silkscreened outline, and sometimes even 3D view.</li>
<li>Use PCBNEW to define the board’s boundary, arrange the footprints on the board, add traces connecting components, and add annotations that will be silkscreened.</li>
</ol>
<p><a href="https://www.youtube.com/watch?v=zK3rDhJqMu0">This video tutorial by Widsor Schmidt</a> was well done.
He walks you through the whole process (opening KiCAD for the first time to finished PCB layout) in 20 minutes.
I watched it repeatedly on 2x speed, pausing so I could follow along.</p>
<p><strong> Schematic </strong></p>
<p>I don’t remember what tutorials I used for learning how to set up a schematic using KiCAD’s EESCHEMA program, but Schmidt’s video also covers that.
I first used it a few years ago, and recall that I spent an evening to go from “KiCAD seems interesting” to “hand-sketched emergency stop schematic for my robot is now laid out nicely”.
Here’s my oscillator circuit as represented in EESCHEMA:</p>
<p><img title="" for="" created="" oscillator,="" src="/images/my_first_pcb/schematic_eeschema.png" alt="" schematic="" with="" eeschema""=""></p>
<p><strong> Component Selection </strong></p>
<p>Next, we need to associate the symbols on the schematic with a real-world component that matches the required specs.
This requires both picking the actual components you’ll use during assembly and specifying the footprint they need on the board.</p>
<p>If you want to use components that aren’t in one of KiCAD’s built-in libraries, you can make your own footprint.
I’ll have to learn this eventually, but since my plan was to solder female headers to the board so I could swap components out, this was irrelevant.
To save time on your first board, you can just use through-hole components with bendable leads (which you probably already have from breadboarding!) or footprints that are already in the libraries.
If you’re desperate/lazy, just use the footprints from the <a href="https://kicad.github.io/footprints/Connector_PinHeader_2.54mm">connector library</a> -- they’ll work for anything that you were able to use on a 0.1” pitch breadboard!</p>
<p>The exceptions to this are the power switch and battery, both of which took me a long time to find and aren’t part of a typical breadboarding kit.
I passionately hate <a href="https://www.digikey.com/">Digikey’s</a> search interface.
It is shockingly bad at having the right metadata for filtering to be effective.
<a href="https://www.mouser.com/">Mouser</a> is sometimes better, but I'm still not a fan.
So, here are some good-enough options:</p>
<ul>
<li>I used <a href="https://www.sparkfun.com/products/102">these</a> breadboard-friendly switches from Sparkfun. I also like the <a href="https://www.mouser.com/ProductDetail/611-JS202011CQN">C&amp;K JS202011CQN</a>, which has a footprint in the KiCAD <a href="https://kicad.github.io/footprints/Button_Switch_THT">Button_Switch_THT library</a>.</li>
<li>I used a coin cell battery to power my project. There are KiCAD footprints for the <a href="https://www.digikey.com/product-detail/en/keystone-electronics/3000TR/36-3000CT-ND/1532229">Keystone 3000</a> (12mm) battery holder and <a href="https://www.mouser.com/ProductDetail/Keystone-Electronics/3008?qs=Mn60vILZNNaVxpUY7xQk0w%3D%3D">Keystone 3008</a> (24mm). I prefer the <a href="https://www.mouser.com/ProductDetail/Harwin/S8211-46R?qs=%2Fha2pyFaduitW8MYXNmFyAOddemjIubonMIopPD95c0%3D">Harwin S8211-46R</a> for a 20mm battery because it’s easier to get the battery in/out, but there isn’t a built-in KiCAD footprint.</li>
</ul>
<p>If you want to scale down components to make the final board smaller, you’ll have to spend time shopping ... and scaling down in size also means figuring out how to do surface-mount soldering with tiny components.
I may get to that someday, but not yet.</p>
<p><strong> Board Layout </strong></p>
<p>The next step was to lay out my circuit as it would appear on a PCB.</p>
<p>I fiddled with the layout a lot (entirely redoing it 3x), and had lots of drudgery figuring out how to get the silkscreening to look almost right.
I still don’t have a process that I love for that ... I imported <a href="https://commons.wikimedia.org/wiki/Category:SVG_electrical_symbols#/media/File:Electrical_Symbols_IEC.svg">public domain electrical symbols</a> as bitmaps, but it was hard to get their leads to have the exact same width to match.</p>
<p>Here's the representation of my board from pcbnew, showing all of the layers at once:</p>
<p><img class="center" width="65%" src="/images/my_first_pcb/pcbnew.png"></p>
<p>I don’t remember when/how I came up with the idea for making the circuit diagram part of the PCB design, but I suspect it was influenced by having seen <a href="https://circuitclassics.com/">Star Simpson’s Circuit Classics</a><sup id="sf-my-first-pcb-6-back"><a title=" I was chagrined to rediscover her work while halfway through this project, and then realize that she actually did this exact same circuit! Our implementations wound up being rather different, but I did use her idea for a battery cutout. " class="simple-footnote" href="#sf-my-first-pcb-6">6</a></sup> at some point.</p>
<p><strong> Fabrication </strong></p>
<p>Once you’re happy with the circuit layout, head over to <a href="http://oshpark.com/">OSHPark</a> and upload your kicad_pcb file.
Their interface is fantastic, and provides a nice rendering for you to do a final check on each layer, in addition to what the whole stackup will look like when manufactured:</p>
<div class="figure">
  <img src="/images/my_first_pcb/oshpark_top.png" width="49%">
  <img src="/images/my_first_pcb/oshpark_bottom.png" width="49%">
  <p type="caption">
    Renderings of the front (left) and back (right) of my PCB, generated by OSHPark.
  </p>
</div>

<p>I didn't spec out the full market of available fabricators because OSHPark hit a sweet spot for me at the intersection of "cheap enough to do on a whim" and "caters to hobbyists/small batches, plays exceedingly well with KiCAD”, with a bonus of “the EE at work uses them for custom boards for our several million dollar robot, so quality must be OK”.
Seriously, actually placing the order was the easiest part of this whole process.
Their automatic import (straight from KiCAD’s .kicad_pcb format) automagically worked.</p>
<p>My first version of the layout was going to cost $7.85 to get 3 copies of the board.
I made it bigger for aesthetic reasons, so I wound up spending $20.05, and shipping is free.</p>
<p><strong> Results!! </strong></p>
<p>OSHPark did a great job, and they’re prettier than I expected!</p>
<p>I assembled two out of the three -- one with header<sup id="sf-my-first-pcb-7-back"><a title=" For this build, I used standard female header, cut apart with my wirecutters. It didn't work very well. In addition to being ugly, the components fit loosely. Next time, I'll use machine pin header, which provides a tighter fit for component leads and comes in a breakaway version even for female header. " class="simple-footnote" href="#sf-my-first-pcb-7">7</a></sup> so I can swap in and out different components, and one with blue LEDs tuned to flash at about 1 Hz.</p>
<div class="figure">
  <img width="45%" src="/images/my_first_pcb/assembled_off_components.jpg" alt="Assembled PCB with components">
  <img width="54%" src="/images/my_first_pcb/assembled_header2.jpg" alt="Assembled PCB with header">
  <p class="caption">
    Assembled boards!
  </p>
</div>

<p>The rough bits around the edges are mousebites, which are added by OSHPark in order to attach my board to others during the fabrication process.
Afterwards, the thin tabs break easily, separating the boards.
I don’t really want to sand fiberglass, so I may try covering them with clear nail polish.</p>
<p>There are a few issues that I'd fix in a v2:</p>
<ul>
<li>One of the vias is under the battery, and for some reason, it isn't covered with solder mask. Given that it's a bit recessed, it probably wouldn't have made contact, but to be safe, I put down a piece of kaptan tape. I think “tented via” may be the right keyword here?</li>
<li>The negative battery pad is also recessed, and the battery isn't making contact. For now, I applied a bit of solder to raise it up. I think the real fix may be to re-design the battery footprint such that the central pad is bigger and/or has a wider border of no-copper around it.</li>
<li>My LEDs don't turn off as quickly as the RC ornament one did. This has nothing to do with PCB design, and everything with me not yet fully understanding how different components affect the circuit. The header test board is meant to make testing my understanding easier!</li>
</ul>
<p>However, I’m pretty happy with this! While I still have lots to learn, the workflow seems solid. My next step will be figuring out how to add my own footprints so I can use any component I want.</p>
<!-- NOW I see why you'd want a plugin rather than raw html. I want to be able to use markdown within this paragraph, but since I've styled it with HTML, I can't. Blech. -->

<p class="thanks">
<strong> Acknowledgements: </strong>

Huge thanks to the community at RC for inspiring both the project and the writeup! <a href="https://github.com/strickinato/recurse-christmas-pcb">Aaron Strick</a> &amp; Noah Zachary Gordon provided the original inspiration and encouragement to post this. <a href="https://twitter.com/veronica_hanus">Veronica Hanus</a> &amp; <a href="http://schuessler.org/">Robert Schuessler</a> commented on an earlier draft.
</p><ol class="simple-footnotes"><li id="sf-my-first-pcb-1">
A Printed Circuit Board (PCB) provides places to attach the components in your circuit (pads/footprints) and provides the required electrical connections between them (traces).
 <a class="simple-footnote-back" href="#sf-my-first-pcb-1-back">↩</a></li><li id="sf-my-first-pcb-2">
If you need inspiration, how about <a href="https://circuitdigest.com/electronic-circuits/push-button-led-circuit">a LED that lights up when you push a button</a>, or <a href="https://www.evilmadscientist.com/2007/a-simple-and-cheap-dark-detecting-led-circuit/">a LED that turns on in the dark</a>? Or, check out the 100 simple circuits in the back of <a href="https://www.amazon.com/Getting-Started-Electronics-Forrest-Mims/dp/0945053282">Forrest Mims's "Getting Started in Electronics"</a>.
 <a class="simple-footnote-back" href="#sf-my-first-pcb-2-back">↩</a></li><li id="sf-my-first-pcb-3">
These are lots of websites explaining how this works.
Here's a <a href="https://www.falstad.com/circuit/e-multivib-a.html">nice simulation</a>, and here's a <a href="https://www.electronics-tutorials.ws/waveforms/astable.html">simpler explanation</a>.
 <a class="simple-footnote-back" href="#sf-my-first-pcb-3-back">↩</a></li><li id="sf-my-first-pcb-4">
I'm always frustrated by the awkward layout and the fiddly solder bridges protoboard requires. However, it's useful if you want to make a breadboarded circuit more permanent without actually making a PCB. If you have to use protoboard, I like <a href="https://www.amazon.com/Gikfun-Solder-able-Breadboard-Plated-Arduino/dp/B071R3BFNL">these from gikfun</a> because they have the same electrical connectivity as a breadboard. (Adafruit's perma-proto is also good, but more expensive.) You can't get the layout as dense as you can on <a href="https://www.amazon.com/AiTrip-Prototype-Universal-Protoboard-Compatible/dp/B07W83VJGV">other protoboard</a>, but it cuts down on how many solder bridges you have to create.
 <a class="simple-footnote-back" href="#sf-my-first-pcb-4-back">↩</a></li><li id="sf-my-first-pcb-5">
I used v4 for this project, but you should definitely use v5. They fixed a lot of the rough edges, and it's more pleasant all-around.
 <a class="simple-footnote-back" href="#sf-my-first-pcb-5-back">↩</a></li><li id="sf-my-first-pcb-6">
I was chagrined to rediscover her work while halfway through this project, and then realize that she actually did this exact same circuit! Our implementations wound up being rather different, but I did use her idea for a battery cutout.
 <a class="simple-footnote-back" href="#sf-my-first-pcb-6-back">↩</a></li><li id="sf-my-first-pcb-7">
For this build, I used standard female header, cut apart with my wirecutters. It didn't work very well. In addition to being ugly, the components fit loosely. Next time, I'll use machine pin header, which provides a tighter fit for component leads and comes in a breakaway version even for female header.
 <a class="simple-footnote-back" href="#sf-my-first-pcb-7-back">↩</a></li></ol>
  </div><!-- /.entry-content -->
</article>

      </section>
  </body>
</html>